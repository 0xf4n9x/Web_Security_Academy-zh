---
description: '原文链接：https://portswigger.net/web-security/authentication/password-based'
---

# 基于密码登录中的漏洞

在本节中，我们将更仔细地研究一些基于密码的登录机制中最常见的漏洞。我们还将提出这些漏洞有可能被利用的方法。甚至还有一些互动实验，让你可以自己尝试利用这些漏洞。

对于采用基于密码的登录过程的网站，用户要么自己注册一个账户，要么由管理员分配一个账户。这个账户与一个独特的用户名和一个秘密密码相关联，用户在登录表格中输入这些密码来验证自己。

在这种情况下，仅凭他们知道秘密密码这一事实，就足以证明用户的身份。因此，如果攻击者能够获得或猜到另一个用户的登录凭证，网站的安全性就会受到影响。

这可以通过各种方式实现，我们将在下面探讨。

### 暴力破解攻击

暴力破解攻击是指攻击者使用反复试验的系统来试图猜测有效的用户凭证。这些攻击通常是使用用户名和密码的字典自动进行的。自动化这一过程，特别是使用专用工具，有可能使攻击者能够高速进行大量的登录尝试。

暴力破解并不总是只对用户名和密码进行完全随机的猜测。通过使用基本的逻辑或公开的常识，攻击者可以对暴力攻击进行微调，以做出更有根据的猜测。这大大提高了这种攻击的效率。依赖密码登录作为唯一验证用户身份方法的网站，如果不实施足够的暴力破解攻击保护，将非常容易受到攻击。

#### 暴力破解用户名 <a id="brute-forcing-usernames"></a>

如果用户名符合一种可识别的模式，如电子邮件地址，那么就特别容易被猜中。例如，很常见的是，商业网站登录的格式是`firstname.lastname@somecompany.com`。然而，即使没有明显的模式，有时甚至高权限的账户也是使用可预测的用户名创建的，如`admin`或`administrator`。

在审计过程中，检查网站是否公开了潜在用户名。例如，你是否能够在不登录的情况下访问用户档案？即使档案的实际内容被隐藏，用户档案中使用的名字有时与登录用户名相同。你还应该检查HTTP响应，看看是否有任何电子邮件地址被泄漏。偶尔，响应中会包含管理员和IT支持等高权限用户的电子邮件地址。

#### 暴力破解密码 <a id="brute-forcing-passwords"></a>

密码也同样可以被暴力破解，其难度根据密码的强度而变化。许多网站采用了某种形式的密码策略，迫使用户创建高熵的密码，至少在理论上，这种密码更难被暴力破解。这通常包括强制要求密码具有：

* 最少的字符数 
* 小写和大写字母的混合体 
* 至少有一个特殊字符 

然而，虽然高熵的密码仅靠计算机是很难破解的，但我们可以利用人类行为的基本常识来利用用户在不知不觉中引入该系统的漏洞。用户往往不是用随机的字符组合来创建一个强大的密码，而是采取一个他们能够记住的密码，并试图将其与密码策略相匹配。例如，如果不允许使用`mypassword`，用户可能会尝试使用`Mypassword1!`或`Myp4$$w0rd`这样的东西来代替。

在政策要求用户定期更改密码的情况下，用户通常会对他们的首选密码进行微小的、可预测的更改。例如，`Mypassword1!`变成了`Mypassword1?`或`Mypassword2!`。

这种对可能的凭证和可预测的模式的了解，意味着暴力攻击往往比简单地迭代每一个可能的字符组合要复杂得多，因此也有效。

#### 用户名枚举 <a id="username-enumeration"></a>

用户名枚举是指攻击者能够观察到网站行为的变化，以确定一个特定的用户名是否有效。

用户名枚举通常发生在登录页面，例如，当你输入一个有效的用户名但密码不正确时，或者在注册表格中输入一个已经被占用的用户名时。这大大减少了暴力登录所需的时间和精力，因为攻击者能够迅速生成一个有效用户名的短名单。

在尝试对登录页面进行暴力破解时，你应该特别注意以下方面的任何差异：

**状态码**：在暴力破解攻击中，返回的HTTP状态码对于绝大多数的猜测都可能是一样的，因为大多数的猜测都是错误的。如果一个猜测返回一个不同的状态码，这是一个强有力的迹象，表明该用户名是正确的。对于网站来说，无论结果如何，总是返回相同的状态码是最好的做法，但这种做法并不总是被遵循。

**错误信息**：有时返回的错误信息是不同的，这取决于用户名和密码都不正确，还是只有密码不正确。对于网站来说，最好的做法是在这两种情况下都使用相同的通用信息，但小的输入错误有时会悄悄出现。只要有一个字符出错，就会使两种信息截然不同，即使在渲染的页面上看不到该字符。

**响应时间**：如果大多数请求的处理都有类似的响应时间，那么任何偏离这个时间的请求都表明在幕后有不同的事情发生。这是另一个迹象，表明猜测的用户名可能是正确的。例如，一个网站可能只在用户名有效的情况下检查密码是否正确。这个额外的步骤可能会导致响应时间的轻微增加。这可能是微妙的，但攻击者可以通过输入一个过长的密码，使网站需要明显的时间来处理，从而使这种延迟更加明显。

### 有缺陷的暴力破解保护



### HTTP basic 认证 <a id="http-basic-authentication"></a>







